---
title: "Workingtodata"
format: html
---

# Files packages Installation

## File setup: Install the required packages

```{r install.packages}
#install.packages("tidyverse")

```

## Library

✔️#did the library for ggplot2

```{r load-Library}
library(tidyverse)
library(descr)
library(knitr)
library(ggplot2)
library(dplyr)
library(papaja)
library(tinylabels)
```

```{r package For STATA}
# Packages for SAS, SPSS, and Stata
library(haven)
library(labelled)

```

### ✔️Load-Data to File Path

```{r load-data}
# Define the file path (going up one level from /scripts to the main directory)
file_path <- file.path("..", "data", "data.dta")

# Load the CSV file into a dataframe (automatically a tibble)
df <- read_dta(file_path)
#need to rewrite this part.

# View the first few words
head(df)

```

### ❌STAT labeled: looking for

```{r- STAT labelled::look_for}
#STAT files can make a codebook from their files
#codebook <- labelled::look_for(df)
#/bin/sh: 1: r-: not found
```

### Columns Names

```{r}
#check column names
colnames(df)
```

check the column names up

View summary statistics

```{r}
#View summary statistics
summary(df)
```

Check the variable types.

```{r glimpse}
#Check data sturcture
glimpse(df)
```

## ✔️Frequency Tables

Using the descr package to create frequency tables.

### Edad = Age

```{r freq-edad(age)}
# Frequency table for edad, where data was collected
freq(as.ordered(df$edad), plot = FALSE)
```

Interpretation: While I am in the US, this study is a Spanish research study. I will use age as a variable or limit the analyses to a certain age range based on the exploration of the research. The finding that I saw was that there are more surveys between ages 12- 17 being with a frequency of 10. There is also some NA being 17 in which could affect the study if assigned an age number, and need to explore more to verify where it comes from, and there are some age groups that have a frequency of zero, but it's not included.

### Sexo "Sex"

```{r freq-sexo(sex)}
#Frequency table for sexo will be about the type of gender are there.
freq(as.ordered(df$sexo), plot = FALSE)
```

Interpretation

This will depend on who is conducting the survey. When analyzing pre-hand, I thought there would be only two variables, but there are also unknown variables, being 73 NA not wanting to respond, but seeing that one gender. Females did more (1) surveys than males is not what I had in mind (0). The difference, though, is not much, only be less than 250 more or less of a gap, thinking it would be the reverse, that males are on top of the survey than the females.

### Internet Filter

```{r freq- pcfiltro}
# Frequency table for pcfiltro if internet's filter at home.
freq(as.ordered(df$pcfiltro), plot = FALSE)
```

Interpretation

This will be about whether they have an internet filter at their home. Seeing that most are zero(No), being above other variables. Yes, being the integer of 1, and 2 being that they don't know if they have a filter. No being in the lead, having 1589 within all categories, but some of its missing a dataset of NA's 121 that needs to be explored.

### Verporno

```{r}
# (If they see erotic material) frequency on verporno on a PC
freq(as.ordered(df$verporno), plot = FALSE)
```

Interpretation

4 being (3 days or more in the days). 3 being 1-2 days in the week. 0 being never. 1 being less than a day, a month. 2 being 1-3 days per month. There is a placeholder for NA, meaning not wanting to answer, but has a 0 frequency.

### Verporno_mobil

```{r}
# If they seeing erotic material frequency on verporno_mobil.
freq(as.ordered(df$verporno_movil), plot = FALSE)
```

**Interpretation**

0 being never. 1 being less than a day a month. 2 being 1-3 days a month. 3 being 1-2 days a week. 4 being 3 or more days a week. A numerical placeholder of not wanting to answer, with a frequency of 0.

## ✔️Data Management

Missing data

variables for my question

The relationship between age and where they see more between seeing porn on a PC or a mobile? Who sees more Male or female children from the age of 11-18?

For the first one, it would be a filter from PC and mobile, and relate it to age. Add both PC and Mobile to filter male and female through the age range of 11- 18. Using Varibles being logical and adding pc and mobile. Also using an age range.

Missing variables(NA) for when using them. Edad(17), verporno(331), moblie(334), sexo(73).

```{r missing data for question}
#variable using 9 for NA but need to be concrete.
#Assign 6 to be NA
df$edad[df$edad == 9] <- NA
df$sexo[df$sexo == 9] <- NA
df$verporno[df$verporno == 9] <- NA
df$verporno_movil[df$verporno_movil == 9] <- NA
#Recoding based on skip patterns
df$edad[is.na(df$edad)] <- 0
df$sexo[is.na(df$sexo)] <- 0
df$verporno[is.na(df$verporno)] <- 0
df$verporno_movil[is.na(df$verporno_movil)] <- 0
```

**Interpretation**

I used the example for the missing data for the ones that I would use when coding. At first, I would be using a different number to be implemented, but changed my mind to the example and is. na would be null. If any errors are seen in this data missing I would like feedback to know where I can check more thoroughly and correct them.

Filtering the age of Interest.

```{r}
#commented out the broken code
#library(dplyr)

#df$edad <- as.numeric(df$edad)

#filterededad <- df$edad %>% 
 # mutate(edad = as.numeric(edad)
  #subset(filterededad, edad >= 11 & edad <= 18)

edad_filtered <- subset(df$edad, df$edad >= 11 & df$edad <= 18)

print(edad_filtered)

#print(df_filterededad)
#dim(df_filterededad)

```

**Interpretation**

For this coding, I would like to focus and filter the age observation to check the teenagers' surveys when they are exposed to porn, either via pc or mobile, separating the other ages that I don't want to focus on. Focus groups are 11-18, in which there are large amounts of surveys and participants from males and females in this age gap, compared to other sections, 10 and below, also 19-25

# Univariate graphs

### Age range 11 - 18 graph

```{r this is a age graph}

#univariate graph(age range variable)
df %>% 
  
ggplot(aes(x = edad)) + 
  geom_histogram(fill = "lightblue", color = "black") +
  
  coord_cartesian(xlim = c(11, 18)) +
  ggtitle("Age surveyed") +
  
  xlab("age ranged") +
  
  ylab("age limit")

  theme_apa()
  #Just to check what is oject is avaible.
  #str(edad)
  #str(edad_filtered)
```

**Interpretation**

Although the ggplot shows on edad data, which is a continuous graph and not a filtered one is because I tried to shorten the graph to one of the focus groups' age of 11- 18, and you can see in the graph the large amounts of people in those age groups.

### Sexo graphs

```{r}
#This shows the legend and correct understanding for the sepration on survey of male and female. In which it would add to the frequency table. 
#This is a visual difference to see who is male or female on the survey. 
ggplot(df, aes(x = factor(sexo), fill = factor(sexo))) +
  geom_bar() +
  scale_fill_manual(
    values = c("Female" = "pink", "Male" = "steelblue"),
    labels = c("male", "female")
  )
```

**Interpretation**

For the graph of Sexo. I used the visual to know what genders are there within the study and how many each section has to have a clear understanding of which has the most people. At first, I thought it would be male, but I came to realize that it was female. Also, I would use them to determine who watches more porn, either pc or mobile, between both genders, and question myself if they're going to affect the population reason because there are more females than males, as shown in the graph.

## Bivariate

focus on the difference between verporno & Mobil, see who watches more from both genders from the filtered age range. Wanting to focus who is doing more porn between male and female.

## Focus and differentiating between Verporno & Verporno_movil

### Numerical to words for graph of Sexo.

```{r}
#Going to try Numerial to words 
df$sexo <- factor(df$sexo, 
        labels = c("Male", "Female"))


```

### ✔️Verporno focus on barcheck

```{r}
#sexo focus for the bivarte would be male and age range for how
#ggplot(data=edad_filtered) +
 # stat_summary(aes(x=verporno_movil,
           #        y=verporno), 
           #    fun.y=mean, 
            #   geom="bar")


#down below would be a 3 variable crossing with example coding.

#ggplot(data=df) +
 # geom_point(aes(x=verporno, 
               #  y=verporno_movil,
 #                color=sexo),
#method="lm")
  #geom_smooth(aes(x=QuantExplanatoryV, 
                  #y=QuantResponseVar,
                  #color=CategThirdVar), 
   #           method="lm")

#Its not the final but it passes for now. I wanted it a third varible compare and contrast.
#age_filtered_data <- df %>% 
 # filter(edad > 10 & edad < 19)
#summary(age_filtered_data)

#age_filtered_data
 # ggplot(data = age_filtered_data) +
   # stat_summary(aes(x= sexo,
          #         y=as.factor(verporno), 
          #       color=as.factor(verporno_movil)),
          #     fun.y=mean, 
          #     geom="bar")
  
  ggplot(df, aes(x = verporno, fill = sexo)) +
  geom_bar(position = "dodge") +
  labs(title = "Seeing difference within Verporno",
       x = "times per days or months",
       y = "People watching erotic",
       fill = "Gender") +
  theme_minimal()
  #Intepertation on the 0-4 varibales descriptions. For verporno_PC
  
```

#### Interpretation

**"Never", "less than 1 day a month", "1-3 days a month", "1-2 days per week", "3 or more days a week".**

As you can see this bivariate shows the difference between the sexo and verporno. I'm hoping its within the age focus group that I'm studying. Anyway on the x-axis you can see the times per days or month between both genders watching porno. The bold paragraph above would corelate to the number variables on the X-axis. As you can see the only difference would be 0=never and variables 1-4 in which more males watch erotic visuals ,also there is a big gap in which female never watch erotic visual compared to males. This bivariate graph focus on the variables Verporno(hoping its pc) and sexo.

***Not using this coding (don't know if would affect the graphs)***

```{r}
#Object 'raw_categorical_data' not found error
age_filtered_data <- df$verporno %>%
  pivot_longer(
    cols = c(verporno_movil, verporno),
    names_to = "Device",
    values_to = "Frequency_Code"
  ) %>%

  mutate( 
    Frequency_Code = factor(Frequency_Code,
                            levels = c(1, 2, 3, 4, 5),
                            labels = c("less than 1 day a month", "1-3 days a month", "1-2 days per week", "3 or more days a week","Never")), #change these to what they really are
    Device = case_when(
      Device == "verporno_movil" ~ "Mobile",
      Device == "verporno_pc" ~ "PC",
      TRUE ~ Device
    )
  )

print("Long Categorical Data:")
print(long_categorical_data)
```

```{r}
#plot is missing 'gender and Layer 1 is missing 'gender'
ggplot(age_filtered_data, aes(x = Frequency_Code, fill = Device)) +
  geom_bar(position = "dodge") +
  # We can further separate by gender using facets or map gender to another aesthetic
  facet_wrap(~ gender) +
  labs(
    title = "Frequency of Activity by Gender and Device",
    x = "Frequency of Use (Category)",
    y = "Count of Individuals",
    fill = "Device Type"
  ) +
  theme_minimal()
```

Not using this coding. Its example coding.

```{r}
#Not using this coding
#focus on sexo compare and contrast on female.
#ggplot(data=df) +
 # stat_summary(aes(x=sexo,
  #                 y=verporno_movil), 
   #            fun.y=mean, 
    #           geom="bar")
#for this graph it doesn't show me much but need to redo it to know and categorizes the months or dates on how much each sexo watch for both genders.

```

### ✔️Verporno_movil focus bar graph

```{r}
ggplot(df, aes(x = verporno_movil, fill = sexo)) +
  geom_bar(position = "dodge") +
  labs(title = "variable by variable title",
       x = "times per days or months",
       y = "Count",
       fill = "Gender") +
  theme_minimal()
  
  
```

#### Interpretation

**"Never", "less than 1 day a month", "1-3 days a month", "1-2 days per week", "3 or more days a week".**

As you can see this bivariate shows the difference between the sexo and verporno_movil. I'm hoping its within the age focus group that I'm studying. Anyway on the x-axis you can see the times per days or month between both genders watching porno in Mobil access. The bold paragraph above would correlate to the number variables on the X-axis. As you can see the only difference would be 0=never and variables 1-4 in which more males watch erotic visuals in mobiles ,also there is a big gap in which female never watch erotic visual compared to males. This bivariate graph focus on the variables Verporno(hoping its PC) and sexo.

I also want to include that the focus graphs of Verporno and Verporno_movil are different you can see the differences within the frequency table between both variables and that the difference are minimal but there is some difference between the two variables focus.
