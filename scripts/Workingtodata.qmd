---
title: "Workingtodata"
format: html
---

# Files packages Installation

## File setup: Install the required packages

```{r install.packages}
#install.packages("tidyverse")

```

## Library

✔️#did the library for ggplot2

```{r load-Library}
library(tidyverse)
library(descr)
library(knitr)
library(ggplot2)
library(dplyr)
library(papaja)
library(tinylabels)
```

```{r package For STATA}
# Packages for SAS, SPSS, and Stata
library(haven)
library(labelled)

```

### ✔️Load-Data to File Path

```{r load-data}
# Define the file path (going up one level from /scripts to the main directory)
file_path <- file.path("..", "data", "data.dta")

# Load the CSV file into a dataframe (automatically a tibble)
df <- read_dta(file_path)
#need to rewrite this part.

# View the first few words
head(df)

```

### Columns Names

```{r}
#check column names
#colnames(df)
```

check the column names up

View summary statistics

```{r}
#View summary statistics
#summary(df)
```

Check the variable types.

```{r glimpse}
#Check data sturcture
#glimpse(df)
```

# Project Spanish Sample

This study will focus a Spanish sample study used in different countries in which focus consumption erotic visual on teenagers of 11-18.\
**Research Question**

 For the ages 11-18 are their a differences in gender in viewing porn on a computer?

For the ages 11-18 are their a differences in gender in viewing porn on a mobile?

The alternative hypothesis that was made from two categorical variables would be sexo and (verporno)(verporno_movil)

**H1 There is a difference between gender on viewing exotic material.  H2. There is a difference between gender on viewing exotic material through mobile.**

## ✔️Frequency Tables

### Edad = Age

```{r freq-edad(age)}
# Frequency table for edad, where data was collected
freq(as.ordered(df$edad), plot = FALSE)
```

Interpretation

This study is a Spanish research study. I will use age as a variable or limit the analyses to a certain age range based on the exploration of the research. The finding that I saw was that there are more surveys between ages 12- 17 being with a frequency of 10. There is also some NA being 17 in which could affect the study if assigned an age number, and need to explore more to verify where it comes from, and there are some age groups that have a frequency of zero, but it's not included.

### Sexo "Sex"

```{r freq-sexo(sex)}
#Frequency table for sexo will be about the type of gender are there.
freq(as.ordered(df$sexo), plot = FALSE)
```

Interpretation

This will depend on who is conducting the survey. When analyzing pre-hand, I thought there would be only two variables, but there are also unknown variables, being 73 NA not wanting to respond, but seeing that one gender. Females did more (1) surveys than males is not what I had in mind (0). The difference, though, is not much, only be less than 250 more or less of a gap, thinking it would be the reverse, that males are on top of the survey than the females.

### Verporno

```{r verporno}
# (If they see erotic material) frequency on verporno on a PC
freq(as.ordered(df$verporno), plot = FALSE)
```

Interpretation

4 being (3 days or more in the days). 3 being 1-2 days in the week. 0 being never. 1 being less than a day, a month. 2 being 1-3 days per month. There is a placeholder for NA, meaning not wanting to answer, but has a 0 frequency.

### Verporno_mobil

```{r verporno_movil}
# If they seeing erotic material frequency on verporno_mobil.
freq(as.ordered(df$verporno_movil), plot = FALSE)
```

**Interpretation**

0 being never. 1 being less than a day a month. 2 being 1-3 days a month. 3 being 1-2 days a week. 4 being 3 or more days a week. A numerical placeholder of not wanting to answer, with a frequency of 0.

## ✔️Data Management

Missing data

variables for my question

The relationship between age and where they see more between seeing porn on a PC or a mobile? Who sees more Male or female children from the age of 11-18?

For the first one, it would be a filter from PC and mobile, and relate it to age. Add both PC and Mobile to filter male and female through the age range of 11- 18. Using Varibles being logical and adding pc and mobile. Also using an age range.

Missing variables(NA) for when using them. Edad(17), verporno(331), moblie(334), sexo(73).

```{r Missing data}
#variable using 9 for NA but need to be concrete.
#Assign 6 to be NA
df$edad[df$edad == 9] <- NA
df$sexo[df$sexo == 9] <- NA
df$verporno[df$verporno == 9] <- NA
df$verporno_movil[df$verporno_movil == 9] <- NA
#Recoding based on skip patterns
df$edad[is.na(df$edad)] <- 0
df$sexo[is.na(df$sexo)] <- 0
df$verporno[is.na(df$verporno)] <- 0
df$verporno_movil[is.na(df$verporno_movil)] <- 0
```

**Interpretation**

I used the example for the missing data for the ones that I would use when coding. At first, I would be using a different number to be implemented, but changed my mind to the example and is. na would be null. If any errors are seen in this data missing I would like feedback to know where I can check more thoroughly and correct them.

Filtering the age of Interest.

```{r filter of age}
#this would be a filteration of age range between 11-18

edad_filtered <- subset(df$edad, df$edad >= 11 & df$edad <= 18)

print(edad_filtered)


```

**Interpretation**

For this coding, I would like to focus and filter the age observation to check the teenagers' surveys when they are exposed to porn, either via pc or mobile, separating the other ages that I don't want to focus on. Focus groups are 11-18, in which there are large amounts of surveys and participants from males and females in this age gap, compared to other sections, 10 and below, also 19-25

# Univariate graphs

### Age range 11 - 18 graph

```{r this is a age graph}

#univariate graph(age range variable)
df %>% 
  
ggplot(aes(x = edad)) + 
  geom_histogram(fill = "lightblue", color = "black") +
  
  coord_cartesian(xlim = c(11, 18)) +
  ggtitle("Age surveyed") +
  
  xlab("age ranged") +
  
  ylab("age limit")

  theme_apa()
  
```

**Interpretation**

This shows a filtered edad data reason would be to I tried to focus groups' ages of 11- 18.

### Sexo graphs

```{r}
#This shows the legend and correct understanding for the sepration on survey of male and female. In which it would add to the frequency table. 
#This is a visual difference to see who is male or female on the survey. 
ggplot(df, aes(x = factor(sexo), fill = factor(sexo))) +
  geom_bar() +
  scale_fill_manual(
    values = c("Female" = "pink", "Male" = "steelblue"),
    labels = c("male", "female")
  )
```

**Interpretation**

For the graph of Sexo. I used the visual to know what genders are there within the sample survey and how many each section has in order have a clear understanding . At first, I thought it would be male, but I came to realize that it was female. Also, I would use them to determine a difference in gender on viewing porn, either pc or mobile.

## Bivariate

focus on the difference between verporno & Mobil, see who watches more from both genders from the filtered age range. Wanting to focus who is doing more porn between male and female.

## Focus and differentiating between Verporno & Verporno_movil

### Numerical to words for graph of Sexo.

```{r}
#Going to try Numerial to words 
df$sexo <- factor(df$sexo, 
        labels = c("Male", "Female"))


```

### ✔️Verporno Visualization

```{r}
 
  ggplot(df, aes(x = verporno, fill = sexo)) +
  geom_bar(position = "dodge") +
  labs(title = "Seeing difference within Verporno",
       x = "times per days or months",
       y = "People watching erotic",
       fill = "Gender") +
  theme_minimal()
  
  
```

#### Interpretation

**"Never", "less than 1 day a month", "1-3 days a month", "1-2 days per week", "3 or more days a week".**

As you can see this bivariate shows the difference between the sexo and verporno. I'm hoping its within the age focus group that I'm studying. Anyway on the x-axis you can see the times per days or month between both genders watching porno. The bold paragraph above would corelate to the number variables on the X-axis. As you can see the only difference would be 0=never and variables 1-4 in which more males watch erotic visuals ,also there is a big gap in which female never watch erotic visual compared to males. This bivariate graph focus on the variables Verporno(hoping its pc) and sexo.

### ✔️Verporno_movil Visualization

```{r}
ggplot(df, aes(x = verporno_movil, fill = sexo)) +
  geom_bar(position = "dodge") +
  labs(title = "variable by variable title",
       x = "times per days or months",
       y = "Count",
       fill = "Gender") +
  theme_minimal()
  
```

#### Interpretation

**"Never", "less than 1 day a month", "1-3 days a month", "1-2 days per week", "3 or more days a week".**

As you can see this bivariate shows the difference between the sexo and verporno_movil. I'm hoping its within the age focus group that I'm studying. Anyway on the x-axis you can see the times per days or month between both genders watching porno in Mobil access. The bold paragraph above would correlate to the number variables on the X-axis. As you can see the only difference would be 0=never and variables 1-4 in which more males watch erotic visuals in mobiles ,also there is a big gap in which female never watch erotic visual compared to males. This bivariate graph focus on the variables Verporno(hoping its PC) and sexo.

I also want to include that the focus graphs of Verporno and Verporno_movil are different you can see the differences within the frequency table between both variables and that the difference are minimal but there is some difference between the two variables focus.

**Since Gender in this dataset is categorical and time spent on viewing exotic material is also categorical, a Chi -Square test will be used to assess the differences.**

**Since Gender in this dataset is categorical and time spent on viewing exotic material mobile is also categorical, a Chi -Square test will be used to assess the differences.**
